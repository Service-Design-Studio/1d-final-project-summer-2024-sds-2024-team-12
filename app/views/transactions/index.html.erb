<div id="myCarousel" class="carousel slide" data-ride="carousel">
  <!-- Indicators -->
  <ol class="carousel-indicators">
    <% if @frequent_transactions.any? %>
      <li data-target="#myCarousel" data-slide-to="1"></li>
    <% end %>
    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
    
  </ol>

  <!-- Wrapper for slides -->
  <div class="carousel-inner">
    

    <% if @frequent_transactions.any? %>
      <div class="item active">
        <%= image_tag('dbsbackground.png', alt: 'DBS background', class: 'carouselImage') %>
        <div class="carousel-caption">
          <p class="textheader">Suggestion:</p>
          <p class="textbody">Based on your frequent transactions, consider scheduling a payment or creating a shortcut for:</p>
          <ul>
            <% @frequent_transactions.each do |transaction| %>
              <li><%= "#{transaction.name}: #{number_to_currency(transaction.amount, unit: 'SGD ', precision: 2)}" %></li>
            <% end %>
          </ul>
          
            <button class='transparent' id='setupButton'>
              <div class='buttonContainer'>
                <p class='buttonText'>Set up</p>
              </div>
            </button>
          </div>
        
      </div>
    <% end %>
  

  <div class="item">

      <%= image_tag('dbsbackground.png', alt: 'DBS background', class: 'carouselImage') %>
      <div class="carousel-caption">
        <p class="textheader">Welcome to digibank</p>
        <p class="textbody">Enjoy the faster and more convenient way to bank on the go</p>
      </div>
    </div>
    </div>

  <!-- Left and right controls -->
  <a class="left carousel-control" href="#myCarousel" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="right carousel-control" href="#myCarousel" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right"></span>
    <span class="sr-only">Next</span>
  </a>
</div>

<div class='buttons-container'>
  <div class='paynowbutton'>
    <%= link_to new_transaction_path do %>
      <div class='iconButtonContainer'>
        <%= image_tag('paynow.png', alt: 'PayNow Image', class: 'paynowImage') %>
        <p class='iconButtonText'>PayNow</p>
      </div>
    <% end %>
  </div>

  <% ShortcutButton.all.each do |button| %>
    <div class="shortcut-button" id="shortcut_button_<%= button.id %>">
      <%= link_to new_transaction_path(scheduled_transaction: { name: @frequent_transactions.first.name, amount: @frequent_transactions.first.amount }) do %>
        <img src="<%= asset_path 'shortcutbutton.png' %>" alt="<%= button.name_of_widget %>">
      <% end %>
      <p class='iconButtonText'><%= button.name_of_widget %></p>
      <%= form_with(model: button, method: :delete, url: shortcut_button_path(button), data: { confirm: 'Are you sure?' }) do |form| %>
        <%= form.submit 'Delete', class: 'btn btn-danger' %>
      <% end %>
    </div>
  <% end %>
</div>

<div class="transaction-history">
  <h1>Transaction History</h1>
  <div class="recenttransaction">
    <table class="transactions-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Amount</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <% @transactions.each do |transaction| %>
          <tr>
            <td><%= transaction.name %></td>
            <td><%= number_to_currency(transaction.amount, unit: "SGD -", precision: 2) %></td>
            <td><%= link_to "Show", transaction %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

<!-- Popup for more details -->
<div class="popup" id="popup">
  <div class="popup-content">
    <span class="close" id="closePopup">&times;</span>
    <p class='textheader'>Suggestion:</p>
    <p>Based on your past transactions, we noticed that you sent money to 
      <% names = @frequent_transactions.pluck(:name).join(', ') %>
      <%= names %>
    frequently in the past month. Do you want to set up monthly recurring payments?</p>
    <div class="buttons">
      <%= link_to "Schedule Payment", new_transaction_path(scheduled_transaction: { name: @frequent_transactions.first.name, amount: @frequent_transactions.first.amount }), class: 'scheduleButton', id: 'scheduleButton' %>
      <%= link_to "Make a Quick Shortcut", new_shortcut_button_path, class: 'shortcutButton', id: 'shortcutButton' %>
    </div>
  </div>
</div>
