
<html lang="en" class="wf-lato-n4-active wf-inter-n4-active wf-active">
<head>
  <style id="react-native-stylesheet"></style>
  <meta charset="utf-8">
  <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#000000">
  <meta name="description" content="Web site created using create-react-app">
  <link rel="apple-touch-icon" href="/logo192.png">
  <link rel="manifest" href="/manifest.json">
  <title>ACCOUNTS</title>
  <%# <script defer="" src="/static/js/bundle.js"></script> %>
</head>
<body data-new-gr-c-s-check-loaded="14.1185.0" data-gr-ext-installed="" style="margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;">
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div id="root">
    <div class="container">
      <div class="scrollable">
        <div class="homeheader">
          <div class="header">
            <div class="leftcontainer">
              <button class="transparent">
                <img src="/assets/bellwhite.png" alt="bell" class="bell">
              </button>
              <button class="transparent">
                <img src="/assets/eye.png" class="eye">
              </button>
            </div>
            <div class="rightcontainer">

              <% if Current.user %>
              <%= Current.user.phone %>
              <% end %>

              <button class="transparent">
                <img src="/assets/help.png" class="help">
              </button>
              
              <div class="logoutContainer">
                <%= button_to logout_path, method: :delete, class: "transparent" do %>
                  <p class="logoutText">LOG OUT</p>
                <% end %>
              </div>
              



            </div>
          </div>

          <div id="myCarousel" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators">
              <li data-target="#myCarousel" class="active"></li>
              <% if @frequent_transactions.any? %>
              <% @frequent_transactions.each do |transaction| %>
                <li data-target="#myCarousel"></li>
              <% end %>
              <% end %>
              <% if @close_transactions.any? %>
                <li data-target="#myCarousel"></li>
              <% end %>
              <% if session[:country] == 'thailand' %>
                <li data-target="#myCarousel"></li>
              <% end %>
            </ol>

            <!-- Wrapper for slides -->
            <div class="carousel-inner">

              <div class="item active">
                <%= image_tag('dbsbackground.png', alt: 'DBS background', class: 'carouselImage') %>
                <div class="carousel-caption">
                  <p class="textheader">Welcome to digibank</p>
                  <p class="textbody">Enjoy the faster and more convenient way to bank on the go</p>
                </div>
              </div>

              <% if @frequent_transactions.any? %>
               <% @frequent_transactions.each_with_index do |transaction, index| %>
                <div class="item">
                  <%= image_tag('dbsbackground.png', alt: 'DBS background', class: 'carouselImage') %>
                  <div class="carousel-caption">
                    <p class="textheader">Suggestion:</p>
                    <p class="textbody">Based on your frequent transactions, consider scheduling a payment or creating a shortcut for:</p>
                    <ul class="textbody">
                      
                        <li><%= "#{transaction.name}: #{number_to_currency(transaction.amount, unit: 'SGD ', precision: 2)}" %></li>
                      
                    </ul>
                    <button class="transparent" id="setupButton<%= index %>">
                      <div class="buttonContainer">
                        <p class="buttonText">Set up</p>
                      </div>
                    </button>
                  </div>
                </div>
                <% end %>
              <% end %>
              
              <% if @close_transactions.any? %>
                <div class="item">
                  <%= image_tag('dbsbackground.png', alt: 'DBS background', class: 'carouselImage') %>
                  <div class="carousel-caption">
                    <p class="textheader">Suggestion:</p>
                    <p class="textbody">Your card usage is nearing $500. Consider setting up a card limit to manage your spending:</p>
                    <ul>
                      <li><%= "Card Limit: $500" %></li>
                    </ul>
                    <button class='transparent' id='setupLimitButton'>
                      <div class='buttonContainer'>
                        <%= link_to 'Set up Limit', new_cardlimit_path %> 
                      </div>
                    </button>
                  </div>
                </div>
              <% end %>
            
               <% if session[:country] == 'thailand' %>
                <div class = "item">
                  <%= image_tag('dbsbackground.png', alt: 'DBS background', class: 'carouselImage') %>
                  <div class="carousel-caption">
                    <p class="textheader">Suggestion:</p>
                    <p class="textbody">You are in Thailand now, do you want to try our PromptPay feature?</p>
                    <button class="transparent">
                      <div class="buttonContainer">
                        <a href = "/promptpay" class="buttonText">Go Now</a>
                      </div>
                    </button>
                  </div>
                </div>
            <% end %>

            </div>

            <!-- Left and right controls -->
            <a class="left carousel-control" href="#myCarousel" data-slide="prev">
              <span class="glyphicon glyphicon-chevron-left"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#myCarousel" data-slide="next">
              <span class="glyphicon glyphicon-chevron-right"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
        <div class="containertwo">
          <p class="text">Smart Shortcuts</p>
          <img src="/assets/settings.png" class="setting">
        </div>
        
        <div class="containerthree">
          <div class="scrollview">

           <% if @frequent_transactions.any? %>
            <% ShortcutButton.all.each do |button| %>
              <div class="scshortcut-button">
                <div class="sciconcontainer">
                  <%= link_to new_transaction_path(scheduled_transaction: { name: button.recipient_name, amount: button.amount }) do %>
                    <div class="scicons"><%= button.nickname %></div>
                    
                  <% end %>
                  <%= form_with(model: button, method: :delete, url: shortcut_button_path(button), data: { confirm: 'Are you sure?' }) do |form| %>
                    <%= form.submit 'Delete', class: 'btn btn-danger' %>
                  <% end %>
                </div>
              </div>
            <% end %>
          <% end %>
            

            <button id="paynowbutton" class="transparent">
              <%= link_to new_transaction_path do %>
                <div class="iconcontainer">
                  <%= image_tag("/assets/paynow.png", alt: 'PayNow Image', class: "icons") %>
                  <p class="shortcut">PayNow</p>
                </div>
              <% end %>
            </button>

            <button class="transparent">
              <%= link_to transaction_history_path do %>
              <div class="iconcontainer">
                <img src="/assets/transaction_history.png" class="icons">
                <p class="shortcut">Transaction</p>
                <p class="shortcut">History</p>
              </div>
              <% end %>
            </button>

            <button id="overseasbutton" class="transparent">
              <%= link_to overseas_transfer_path do %>
                <div class="iconcontainer">
                  <%= image_tag("/assets/overseas.png", alt: 'Overseas Image', class: "icons") %>
                  <p class="shortcut">Overseas</p>
                  <p class="shortcut">Transactions</p>
                </div>
              <% end %>
            </button>


            <button id="transfermoney" class="transparent">
              <div class="iconcontainer">
                <img src="/assets/local_transfer.png" class="icons">
                <p class="shortcut">Transfer Money</p>
              </div>
            </button>

            <button id="scanpay" class="transparent">
              <div class="iconcontainer">
                <img src="/assets/scan&amp;pay.png" class="icons">
                <p class="shortcut">Scan &amp; Pay</p>
              </div>
            </button>

            

            <button class="transparent">
              <div class="iconcontainer">
                <img src="/assets/local_transfer_limit.png" class="icons">
                <p class="shortcut">Local Transfer</p>
                <p class="shortcut">Limit</p>
              </div>
            </button>

            <button class="transparent">
              <div class="iconcontainer">
                <img src="/assets/livebetter.png" class="icons">
                <p class="shortcut">Live Better</p>
              </div>
            </button>

            <button class="transparent">
              <div class="iconcontainer">
                <img src="/assets/bill.png" class="icons">
                <p class="shortcut">Bills</p>
              </div>
            </button>

            <button class="transparent">
              <div class="iconcontainer">
                <img src="/assets/setpeekbalance.png" class="icons">
                <p class="shortcut">Set Peek</p>
                <p class="shortcut">Balance</p>
              </div>
            </button>

            <button class="transparent">
              <div class="iconcontainer">
                <img src="/assets/scheduletransfer.png" class="icons">
                <p class="shortcut">Transfers</p>
                <p class="shortcut">Scheduled</p>
              </div>
            </button>

          </div>
        </div>

        <div class="floating-container">
          <button id="thailandButton" class="floating-button coco-transparent">
            <%= image_tag("/assets/coconut.png", alt: "Coconut Image", class: "coco-icons") %>
          </button>
          <button id="removeThailand" class="floating-button">
            not in thailand
          </button>
        </div>

    </scrollable>

      <div class="bottomnav">
        <div class="bottomtabnavigatorcontainer">
          <button class="transparent">
            <img src="/assets/home_bottomfilled.png" alt="home" class="navicon">
            <p class="navtextselected">Home</p>
          </button>
          <button class="transparent">
            <img src="/assets/invest_bottom.png" alt="invest" class="navicon">
            <p class="navtext">Invest</p>
          </button>
          <a href="/pay_and_transfer_page/index">
            <button class="transparent">
              <img src="/assets/pay&amp;transfer_bottom.png" alt="pay" class="navicon">
              <p class="navtext">Pay &amp; Transfer</p>
            </button>
          </a>
          <button class="transparent">
            <img src="/assets/plan_bottom.png" alt="plan" class="navicon">
            <p class="navtext">Plan</p>
          </button>
          <button class="transparent">
            <img src="/assets/more_bottom.png" alt="more" class="navicon">
            <p class="navtext">More</p>
          </button>
        </div>
      </div>

      <div class="tab-container">
        <!-- Tabs -->
        <div class="tabs">
            <div class="tab" onclick="showTab('accounts')">Accounts</div>
            <div class="tab" onclick="showTab('insights')">Insights</div>
        </div>

        <!-- Content for Accounts tab -->
        <div id="tab-accounts" class="tab-content active">
                <!-- Your ACCOUNTS content goes here -->
                <div class="header1">
                    <div class="blueline"></div>
                    <p class="text">Your Net Worth</p>
                    <img src="/assets/expand.png" class="expand2">
                </div>
                <div class="container2">
                    <div class="value">Value</div>
                    <div class="textcontainer">
                        <p class="sgd">SGD</p>
                        <p class="money">29891.00</p>
                    </div>
                </div>
                <div class="line"></div>
                <button class="buttontransparent">
                    <div>
                        <div class="header1">
                            <div class="yellowline"></div>
                            <p class="text">Deposits</p>
                            <img src="/assets/expand.png" class="expandrotated2">
                        </div>
                        <div class="container2">
                            <div class="value">Balance</div>
                            <p class="money">29891.00</p>
                        </div>
                        <div class="line"></div>
                    </div>
                </button>
            
        </div>

        <!-- Content for Insights tab -->
        <div id="tab-insights" class="tab-content">
                <div>
                    <div class="rectangle">
                        <p class="date2">14 JUN</p>
                        <p class="title">Review your budget</p>
                        <p class="body">You've maintained your monthly spending average.</p>
                    </div>
                    <div class="rectangle">
                        <p class="date2">14 JUN</p>
                        <p class="title">Resolve unexpected transactions quickly!</p>
                        <p class="body">Here are some tips for you.</p>
                    </div>
                    <div class="rectangle">
                        <p class="date2">14 JUN</p>
                        <p class="title">Was this deposit expected?</p>
                        <p class="body">You don't often receive money from this source.</p>
                    </div>
                </div>
            </div>
    </div>      
    </div>

    </div>

  </div>

  <!-- Inline JavaScript for tab switching -->
    <script>
        function showTab(tabName) {
        // Hide all tab contents
        var tabContents = document.getElementsByClassName("tab-content");
        for (var i = 0; i < tabContents.length; i++) {
            tabContents[i].style.display = "none";
        }

        // Deactivate all tabs
        var tabs = document.getElementsByClassName("tab");
        for (var i = 0; i < tabs.length; i++) {
            tabs[i].classList.remove("active");
        }

        // Show the selected tab content
        document.getElementById("tab-" + tabName).style.display = "block";

        // Activate the selected tab
        document.querySelector(".tab[onclick='showTab(\"" + tabName + "\")']").classList.add("active");
    }

    </script>


<!-- Popup for more details -->
<% if @frequent_transactions.any? %>
  <% @frequent_transactions.each_with_index do |transaction, index| %>
    <div class="popup" id="popup<%= index %>">
      <div class="popup-content">
        <span class="close" id="closePopup">&times;</span>
    <p class='textheader'>Suggestion:</p>
    <p>Based on your past transactions, we noticed that you sent money to 
      <%# <% names = @frequent_transactions.pluck(:name).join(', ') %>
      <%# <%= names %>
      <%= transaction.name %>
    frequently in the past month. Do you want to set up monthly recurring payments?</p>
        <div class="buttons">
          <%= link_to "Schedule Payment", 
              new_scheduled_transaction_path(
                scheduled_transaction: { 
                  name: transaction.name, 
                  amount: transaction.amount 
                }
              ), 
              class: 'scheduleButton', 
              id: "scheduleButton#{index}" %>
          <%= link_to "Make a Quick Shortcut", 
              new_shortcut_button_path(
                shortcut_button: { 
                  recipient_name: transaction.name,
                  amount: transaction.amount,
                  nickname: ""
                }
              ), 
              class: 'shortcutButton', 
              id: "shortcutButton#{index}" %>
        </div>
      </div>
    </div>
  <% end %>
<% end %>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var thailandButton = document.getElementById('thailandButton');
    if (thailandButton) {
      thailandButton.addEventListener('click', function() {
        const isActive = this.classList.contains('active');
        const url = isActive ? '/remove_location/thailand' : '/set_location/thailand';
        const method = isActive ? 'DELETE' : 'POST';

        fetch(url, { 
          method: method,
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body: JSON.stringify({ country: 'thailand' }) // If your server expects data
        })
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP status ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          if(data.success) {
            this.classList.toggle('active');
            location.reload(); // Reload the page to update the carousel
          }
        })
        .catch(error => console.error('Fetch error:', error));

      });
    } else {
      console.error('Thailand button not found');
    }
  });

  document.addEventListener('DOMContentLoaded', function() {
    var removeButton = document.getElementById('removeThailand');
    var coconutButton = document.getElementById('thailandButton');

    removeButton.addEventListener('click', function() {
      fetch('/remove_location/thailand', { method: 'DELETE' })
        .then(response => response.json())
        .then(data => {
          if(data.success) {
            coconutButton.style.display = 'none'; // Hide coconut button
            location.reload(); // Optionally reload or manually reset carousel
          }
        })
        .catch(error => console.error('Error:', error));
    });
  });



</script>
</html>
